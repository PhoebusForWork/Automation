# -*- coding: utf-8 -*-
from utils.database_utils import ElasticsearchTool
import datetime
import json



def printJson(func):
    print(json.dumps(func, sort_keys=True, indent=4, separators=(',', ':')))


test = ElasticsearchTool()
now = datetime.datetime.utcnow().strftime('%Y-%m-%dT%H:%M:%S.000Z')  # 時間只能到毫秒後三位，超過的話api會報錯

    #加入單一的資料如下
abc ={"_score":None,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"996431dff4843bd9003f7385fe3b3284","account":"vv666","account_id":224,"department":"測試部","department_id":3,"role":"测试员","http_method":"POST","headers":{"x-request-id":"50c4b422-81ca-96c4-a22e-e9a673ebdeff","content-length":"42","x-b3-parentspanid":"003f7385fe3b3284","device_id":"3263782594","x-forwarded-proto":"https","postman-token":"fce6c16a-df3f-4e39-8903-a2622b6f24f1","x-b3-sampled":"1","token":"b98655b6-4f44-4bc6-ad5d-0f24288f6817","accept":"*/*","x-envoy-attempt-count":"1","x-envoy-external-address":"61.220.72.61","x-b3-traceid":"996431dff4843bd9003f7385fe3b3284","x-b3-spanid":"9e5f5043ec48e39f","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=37a2023622ec7a9603d92f816d4f722ea3e43cc036d47ccc46e49934a02a1346;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"gzip, deflate, br","user-agent":"PostmanRuntime/7.28.4"},"request_parameters":{"currency":["CNY"]},"response_status":200,"business_type":"CLEAN","action_log_content_title":"一鍵流水清零","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.wallet.v1.WaterManageController.clearWithdrawWaterAndValidWater","ip":"61.220.72.61","log_time":"2023-05-05T08:23:43.273Z"};
abc['log_time'] = now
t = test.add_data(index='ldpro_basics_admin_action_log', doc_type='_doc', json_data=abc)
printJson(t)

#塞入多筆資料格式範例
# data_list = [{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"05d25cf88e50621c92b733438ca41129","account":"superAdmin","account_id":1,"department":"測試部","department_id":3,"role":"超级管理员","http_method":"GET","headers":{"x-request-id":"88bd8f60-6ddb-9bcf-a938-e81b03fb284e","content-length":"2","x-b3-parentspanid":"92b733438ca41129","os-type":"0","x-forwarded-proto":"https","x-b3-sampled":"1","sign":"ODMwYzA4NmE5YmFjYTNhOTZiNzIzZjkyMzk2NzExYWM=","device-id":"3263782594","version":"1.0","accept":"application/json, text/plain, */*","token":"a52ce9bb-90e3-48a6-afd6-e509cb3b1544","x-envoy-attempt-count":"1","x-envoy-external-address":"35.194.237.247","x-b3-traceid":"05d25cf88e50621c92b733438ca41129","x-b3-spanid":"f57a3139f4c2b5a6","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=5862e73a2a816785a3bca476b421e2dbf0964f6b5305c9e9077bf52ff11f0553;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"identity","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36","timestamp":"1679393000"},"request_parameters":{"roleId":["2"]},"response_status":200,"business_type":"SELECT","action_log_content_title":"節點列表","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.account.v1.DepartmentController.listDepartment","ip":"35.194.237.247","log_time":"2023-03-21T10:03:20.849Z"},{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"fc98c44dfa624b48e500465f91683f0c","account":"superAdmin","account_id":1,"department":"測試部","department_id":3,"role":"超级管理员","http_method":"POST","headers":{"x-request-id":"e3a80b92-6ab3-9530-a9bd-3057a2757c1e","content-length":"2","x-b3-parentspanid":"e500465f91683f0c","os-type":"0","x-forwarded-proto":"https","x-b3-sampled":"1","sign":"NjAxZjM0ZjhlMGYxMWM0OWQ4OTE5ODM2ZTVhZTM0ZjI=","device-id":"3263782594","version":"1.0","accept":"application/json, text/plain, */*","token":"d183b36c-443a-48ac-b50f-c4943c77beab","x-envoy-attempt-count":"1","x-envoy-external-address":"35.194.237.247","x-b3-traceid":"fc98c44dfa624b48e500465f91683f0c","x-b3-spanid":"f4558c6f0a41d904","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=5862e73a2a816785a3bca476b421e2dbf0964f6b5305c9e9077bf52ff11f0553;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"identity","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36","timestamp":"1679393032"},"request_parameters":{"isTesting":["True"]},"response_status":400,"business_type":"OTHER","action_log_content_title":"同步遊戲數據","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.game.v1.GameController.syncGameConfig","ip":"35.194.237.247","log_time":"2023-03-21T10:03:52.463Z"},{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"07e7eeb05be7e3879fbc831995b09225","account":"superAdmin","account_id":1,"department":"測試部","department_id":3,"role":"超级管理员","http_method":"POST","headers":{"x-request-id":"c94be074-524a-9bcd-97ca-52718dbab361","content-length":"29","x-b3-parentspanid":"9fbc831995b09225","os-type":"0","x-forwarded-proto":"https","x-b3-sampled":"1","sign":"NmE3YjA0Mzc1ZjhmZDZjNGViYWQyZjk1ZTcwYjc2MGE=","device-id":"3263782594","version":"1.0","accept":"application/json, text/plain, */*","token":"a52ce9bb-90e3-48a6-afd6-e509cb3b1544","x-envoy-attempt-count":"1","x-envoy-external-address":"35.194.237.247","x-b3-traceid":"07e7eeb05be7e3879fbc831995b09225","x-b3-spanid":"010790e9509249cb","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=5862e73a2a816785a3bca476b421e2dbf0964f6b5305c9e9077bf52ff11f0553;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"identity","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36","timestamp":"1679393001"},"request_parameters":{},"response_status":400,"business_type":"INSERT","action_log_content_title":"新增節點","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.account.v1.DepartmentController.addDepartment","ip":"35.194.237.247","log_time":"2023-03-21T10:03:21.678Z"},{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"f656ccc1009de92b3bcca273e8b42bc7","account":"superAdmin","account_id":1,"department":"測試部","department_id":3,"role":"超级管理员","http_method":"PUT","headers":{"x-request-id":"ad704e33-a1dd-90b4-a487-a4f95a16c40e","content-length":"31","x-b3-parentspanid":"3bcca273e8b42bc7","os-type":"0","x-forwarded-proto":"https","x-b3-sampled":"1","sign":"OTNlZjkxNGVjYmY0M2M4MGMyOTIyZGI2YTcxNjViNWY=","device-id":"3263782594","version":"1.0","accept":"application/json, text/plain, */*","token":"a52ce9bb-90e3-48a6-afd6-e509cb3b1544","x-envoy-attempt-count":"1","x-envoy-external-address":"35.194.237.247","x-b3-traceid":"f656ccc1009de92b3bcca273e8b42bc7","x-b3-spanid":"17f3abc813f9e144","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=5862e73a2a816785a3bca476b421e2dbf0964f6b5305c9e9077bf52ff11f0553;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"identity","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36","timestamp":"1679393002"},"request_parameters":{},"response_status":400,"business_type":"UPDATE","action_log_content_title":"設置負責人","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.account.v1.DepartmentController.updateDepartmentLeader","ip":"35.194.237.247","log_time":"2023-03-21T10:03:22.186Z"},{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"e5662f06eb633779369d58d800709882","account":"superAdmin","account_id":1,"department":"測試部","department_id":3,"role":"超级管理员","http_method":"DELETE","headers":{"x-request-id":"25e8b503-640e-992c-9d51-8baca4b81237","content-length":"2","x-b3-parentspanid":"369d58d800709882","os-type":"0","x-forwarded-proto":"https","x-b3-sampled":"1","sign":"OTNlZjkxNGVjYmY0M2M4MGMyOTIyZGI2YTcxNjViNWY=","device-id":"3263782594","version":"1.0","accept":"application/json, text/plain, */*","token":"a52ce9bb-90e3-48a6-afd6-e509cb3b1544","x-envoy-attempt-count":"1","x-envoy-external-address":"35.194.237.247","x-b3-traceid":"e5662f06eb633779369d58d800709882","x-b3-spanid":"47768ebd64d86adc","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=5862e73a2a816785a3bca476b421e2dbf0964f6b5305c9e9077bf52ff11f0553;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"identity","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36","timestamp":"1679393002"},"request_parameters":{},"response_status":400,"business_type":"DELETE","action_log_content_title":"刪除節點","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.account.v1.DepartmentController.deleteDepartment","ip":"35.194.237.247","log_time":"2023-03-21T10:03:22.715Z"},{"_score":1,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"f037a33933a08240b3f2a7202a4dee19","account":"fidio666","account_id":1492,"department":"測試部","department_id":3,"role":"测试员","http_method":"POST","headers":{"content-length":"0","referer":"https://admin-qa.prj300.xyz/login?redirect=/permission/adminUser","x-b3-parentspanid":"b3f2a7202a4dee19","os-type":"WEB","sec-fetch-site":"same-origin","origin":"https://admin-qa.prj300.xyz","x-b3-sampled":"1","sign":"wxX1wz6Nxdym0001L6Kjsg==","device-id":"1265264380","x-envoy-original-path":"/api/v1/account/login/imgCode?uuid=1265264380","x-envoy-external-address":"60.250.69.212","sec-ch-ua-mobile":"?0","host":"admin-qa.prj300.xyz","timestamp":"1680229906000","sec-fetch-mode":"cors","x-request-id":"32f6a79e-128e-911f-a5b5-d36d8ff01cb6","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7","x-forwarded-proto":"https","accept":"application/json, text/plain, */*","token":"5555fa67-ea9b-4913-bba3-fb87cf635bba","x-envoy-attempt-count":"1","sec-ch-ua":"\"Google Chrome\";v=\"111\", \"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"111\"","x-b3-traceid":"f037a33933a08240b3f2a7202a4dee19","x-b3-spanid":"d934cbf6c5098161","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=c7b2a107df90353b788959bf335e1075e6a5e2bc6fc500ab6b4a0084c0d249f6;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","sec-ch-ua-platform":"\"macOS\"","accept-encoding":"gzip, deflate, br","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36","sec-fetch-dest":"empty"},"request_parameters":{"uuid":["1265264380"]},"response_status":200,"business_type":"EXPORT","action_log_content_title":"取得圖形驗證碼","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.account.v1.LoginController.createImgCode","ip":"60.250.69.212","log_time":"2023-03-31T02:31:46.252Z"},{"_score":None,"_class":"com.galaxy.storage.elasticsearch.po.AdminActionLogPo","trace_id":"996431dff4843bd9003f7385fe3b3284","account":"vv666","account_id":224,"department":"測試部","department_id":3,"role":"测试员","http_method":"POST","headers":{"x-request-id":"50c4b422-81ca-96c4-a22e-e9a673ebdeff","content-length":"42","x-b3-parentspanid":"003f7385fe3b3284","device_id":"3263782594","x-forwarded-proto":"https","postman-token":"fce6c16a-df3f-4e39-8903-a2622b6f24f1","x-b3-sampled":"1","token":"b98655b6-4f44-4bc6-ad5d-0f24288f6817","accept":"*/*","x-envoy-attempt-count":"1","x-envoy-external-address":"61.220.72.61","x-b3-traceid":"996431dff4843bd9003f7385fe3b3284","x-b3-spanid":"9e5f5043ec48e39f","x-forwarded-client-cert":"By=spiffe://cluster.local/ns/app/sa/default;Hash=37a2023622ec7a9603d92f816d4f722ea3e43cc036d47ccc46e49934a02a1346;Subject=\"\";URI=spiffe://cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account","host":"api30-qa.prj300.xyz","content-type":"application/json","accept-encoding":"gzip, deflate, br","user-agent":"PostmanRuntime/7.28.4"},"request_parameters":{"currency":["CNY"]},"response_status":200,"business_type":"CLEAN","action_log_content_title":"一鍵流水清零","plt_code":"ldpro","gateway_controller_name":"com.galaxy.pltgateway.controller.wallet.v1.WaterManageController.clearWithdrawWaterAndValidWater","ip":"61.220.72.61","log_time":"2023-05-05T08:23:43.273Z"}]

# for data in data_list:
#     data['log_time'] = now
#     t = test.add_data(index='vs_basics_admin_action_log', doc_type='_doc', json_data=data)
#     printJson(t)